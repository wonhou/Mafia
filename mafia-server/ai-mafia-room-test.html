
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Î∞© ÌÖåÏä§Ìä∏</title>
</head>
<body>
  <h2> Î∞© ÌÖåÏä§Ìä∏</h2>
  <label>Player ID: <input type="text" id="playerId" value="user1"></label><br>
  <label>Room ID: <input type="text" id="roomId" value=""></label><br>
  <label>Room Name: <input type="text" id="roomName" value="ÌÖåÏä§Ìä∏Î∞©"></label><br>
  <button onclick="connect()">1Ô∏è‚É£ Connect</button>
  <button onclick="createRoom()">2Ô∏è‚É£ Create Room</button>
  <button onclick="joinRoom()">3Ô∏è‚É£ Join Room</button>
  <button onclick="startGame()">4Ô∏è‚É£ Start Game</button>
  <br><br>
  <input type="text" id="msg" placeholder="Message">
  <button onclick="send()">üì§ Send</button>
  <ul id="log"></ul>

  <script>
    let socket;

    function log(msg) {
      const ul = document.getElementById("log");
      const li = document.createElement("li");
      li.textContent = msg;
      ul.appendChild(li);
    }

    function connect() {
      socket = new WebSocket("ws://localhost:3000");
      socket.onopen = () => {
        const pid = document.getElementById("playerId").value;
        socket.send(JSON.stringify({ type: "register", playerId: pid }));
        log("‚úÖ Connected and registered: " + pid);
      };
      socket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        log("üì® " + JSON.stringify(data));
        if (data.type === "room_created") {
          document.getElementById("roomId").value = data.roomId;
        }
      };
    }

    function createRoom() {
      const pid = document.getElementById("playerId").value;
      const roomName = document.getElementById("roomName").value;
      socket.send(JSON.stringify({ type: "create_room", playerId: pid, roomName }));
    }

    function joinRoom() {
      const pid = document.getElementById("playerId").value;
      const roomId = document.getElementById("roomId").value;
      socket.send(JSON.stringify({ type: "join_room", playerId: pid, roomId }));
    }

    function startGame() {
      const roomId = document.getElementById("roomId").value;
      socket.send(JSON.stringify({ type: "start_game", roomId }));
    }

    function send() {
      const msg = document.getElementById("msg").value;
      socket.send(JSON.stringify({ type: "chat", text: msg }));
    }
  </script>
</body>
</html>
